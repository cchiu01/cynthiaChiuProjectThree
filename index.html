<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Project 3</title>
    <style>
    
    </style>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
    <script>
        
        myApp = {};
        myApp.randomTrackList = [];
        myApp.playlistFileNames = [];
        myApp.playing = false;
        myApp.audio = {};
        myApp.trackIndex = 0;

        myApp.data = {
                track0: {
                    title: `I Just Can't Wait to Be King`,
                    movie: `Lion King`,
                    source: 'Lion_King_I_Just_Cant_Wait_to_Be_King'
                },
                track1: {
                    title: `I'll Make A Man Out Of You`,
                    movie: `Mulan`,
                    source: 'Mulan_Ill_Make_A_Man_Out_Of_You'
                },
                track2: {
                    title: ``,
                    movie: ``,
                    source: ``
                }
            };
        
        
        myApp.getTrackFileName = function (object) {
            myApp.playlistFileNames = [];
            // create an array from myApp.data.track0.source
            for (let each in object) {
                (myApp.playlistFileNames).push(object[each].source);
            } 
        };
        

        myApp.randomTrackGenerator = function (array){
            myApp.randomTrackList = [];
            // for loop condition breaks when myApp.randomTrackList.length == array.length
            for (let i= 0; myApp.randomTrackList.length < array.length; i++) {
                // generates a random number from 0 to array.length
                let index = Math.floor((Math.random() * array.length));
                // adds index to myApp.randomTrackList.length if value does not exist in newArray
                if (!myApp.randomTrackList.includes(index)) {
                    myApp.randomTrackList.push(index);
                }
            }
        };


        myApp.initAudioPlayer = function (array) {
            myApp.audio = new Audio();
            // displays name of file based on the trackIndex from randomTrackList
            let filename = array[myApp.randomTrackList[myApp.trackIndex]];
            
            console.log(myApp.randomTrackList);
            myApp.audio.src = './audio/' + `${filename}` + `.mp3`;
            if (!myApp.playing) {
                myApp.audio.play(); 
                myApp.playing = true;
            }
        };
        

        myApp.switchTrack = function (array) {
            $('p').click(function () {
                console.log(`it's working!`);
                myApp.trackIndex = myApp.trackIndex + 1;
                let filename = array[myApp.randomTrackList[myApp.trackIndex]];
                myApp.audio.pause();
                myApp.audio.src = './audio/' + `${filename}` + `.mp3`;
                myApp.audio.play();
            })

        }

    $(function (){

        $('button').click(function () {
            myApp.getTrackFileName(myApp.data);
            myApp.randomTrackGenerator(myApp.playlistFileNames);
            myApp.initAudioPlayer(myApp.playlistFileNames);
            myApp.switchTrack(myApp.playlistFileNames);
            

            // $('p').click(function () {
            //     let audio = new Audio();
            //     audio.pause;
            //     console.log(`it's working!`)
                
            // })
            
        })
        

    })
    
    </script>
</head>
<body>
    <button>start</button>
    <div></div>
    <p>Lion King</p>
    <p>Mulan</p>
</body>
</html>